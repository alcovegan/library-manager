# E2E Tests (Playwright + Electron)

End-to-end —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Library Manager —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Playwright.

**‚ö†Ô∏è STRICT MODE:** –í—Å–µ E2E —Ç–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –≤ —Å—Ç—Ä–æ–≥–æ–º —Ä–µ–∂–∏–º–µ:
- –ù–∏–∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–Ω—ã—Ö `if` –ø—Ä–æ–≤–µ—Ä–æ–∫
- –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –î–û–õ–ñ–ù–´ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
- –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –ø—Ä–∏ –ª—é–±–æ–π –ø—Ä–æ–±–ª–µ–º–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `test.skip()` —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/e2e/
‚îú‚îÄ‚îÄ README.md                      # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ helpers/
‚îÇ   ‚îî‚îÄ‚îÄ electron-launcher.js       # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Electron
‚îú‚îÄ‚îÄ vocabulary.e2e.js              # –¢–µ—Å—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä—è–º–∏ (STRICT MODE)
‚îú‚îÄ‚îÄ book-edit.e2e.js               # –¢–µ—Å—Ç—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–∏–≥ –∏ Goodreads (STRICT MODE)
‚îî‚îÄ‚îÄ screenshots/                   # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (gitignored)
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ `npm install`. –ï—Å–ª–∏ –Ω–µ—Ç:

```bash
npm install --save-dev playwright @playwright/test
```

## –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### Headless —Ä–µ–∂–∏–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```bash
npm run test:e2e
```

### –° –≤–∏–¥–∏–º—ã–º –±—Ä–∞—É–∑–µ—Ä–æ–º (headed)
```bash
npm run test:e2e:headed
```

### Debug —Ä–µ–∂–∏–º (—Å –ø–æ—à–∞–≥–æ–≤—ã–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º)
```bash
npm run test:e2e:debug
```

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è E2E —Ç–µ—Å—Ç–æ–≤

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (STRICT MODE)

```javascript
// 1. –°—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ - —ç–ª–µ–º–µ–Ω—Ç –î–û–õ–ñ–ï–ù —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
const button = window.locator('#createBtn');
await expect(button).toBeVisible();
await button.click();

// 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –º–æ–¥–∞–ª –î–û–õ–ñ–ï–ù –æ—Ç–∫—Ä—ã—Ç—å—Å—è
const modal = window.locator('#modal');
await expect(modal).toBeVisible({ timeout: 3000 });

// 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç - –∑–Ω–∞—á–µ–Ω–∏–µ –î–û–õ–ñ–ù–û —Å–æ–≤–ø–∞—Å—Ç—å
const input = window.locator('#titleInput');
await input.fill('Test');
expect(await input.inputValue()).toBe('Test');
```

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–ø–ª–æ—Ö–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏)

```javascript
// 1. –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Å–ª–æ–≤–Ω—ã–µ if - —Ç–µ—Å—Ç –Ω–µ —É–ø–∞–¥—ë—Ç
if (await button.isVisible()) {
  await button.click(); // ‚ùå –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∏ –Ω–µ—Ç, —Ç–µ—Å—Ç –ø—Ä–æ–π–¥—ë—Ç
}

// 2. –ù–ï –ª–æ–≤–∏—Ç–µ –æ—à–∏–±–∫–∏ - —Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã
const isVisible = await modal.isVisible().catch(() => false); // ‚ùå

// 3. –ù–ï –¥–µ–ª–∞–π—Ç–µ always-passing –ø—Ä–æ–≤–µ—Ä–∫–∏
expect(isVisible || true).toBeTruthy(); // ‚ùå –í—Å–µ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç

// 4. –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ not.toThrow
expect(() => someAction()).not.toThrow(); // ‚ùå –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞–ª–æ
```

### üü° –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–∑–∞–≤–∏—Å—è—Ç –æ—Ç –¥–∞–Ω–Ω—ã—Ö)

```javascript
// –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ test.skip() –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
test('should interact with entry if data exists', async () => {
  const entries = window.locator('.vocab-entry');
  const count = await entries.count();

  if (count === 0) {
    test.skip(); // ‚úÖ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
    return;
  }

  // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å - —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
  await expect(entries.first()).toBeVisible();
  await entries.first().click();
  // ...
});
```

## –°—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤

### 1. Vocabulary Management (`vocabulary.e2e.js`) - 10 —Ç–µ—Å—Ç–æ–≤
**Strict checks:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —Å–ª–æ–≤–∞—Ä–µ–π
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ (genres, tags, publisher, series, authors)
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∑–∞–ø–∏—Å–∏ –∏–ª–∏ empty state)

**Optional checks (if data exists):**
- üü° –ö–ª–∏–∫ –ø–æ –∑–∞–ø–∏—Å–∏ —Å–ª–æ–≤–∞—Ä—è (skip if no entries)
- üü° –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–∏–≥ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é (skip if no entries)

### 2. Book Editing & Goodreads (`book-edit.e2e.js`) - 16 —Ç–µ—Å—Ç–æ–≤
**Strict checks:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥–∏
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π (title, authors, Goodreads fields)
- ‚úÖ –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–æ–ª—è
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞ Goodreads
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ Goodreads
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–∏—Å–∫–∞
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–∞ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Å `NODE_ENV=test` –∏ `ELECTRON_TEST=true`
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –Ω–µ –ø–æ–≤—Ä–µ–¥–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ** (workers: 1), —Ç–∞–∫ –∫–∞–∫ Electron –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –≤–∏–¥–µ–æ
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –í–∏–¥–µ–æ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `test-results/` –∏ `playwright-report/`

### –¢–∞–π–º–∞—É—Ç—ã
- –¢–µ—Å—Ç: 60 —Å–µ–∫—É–Ω–¥
- –ê—Å—Å–µ—Ä—Ç—ã: 10 —Å–µ–∫—É–Ω–¥
- –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `playwright.config.js`

## Troubleshooting

### Electron –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. `npm install` –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
2. Electron —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `npx electron --version`
3. –ü—É—Ç—å –∫ `main.js` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –≤ `electron-launcher.js`

### –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º
–£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ `playwright.config.js`:
```javascript
timeout: 120000, // 2 –º–∏–Ω—É—Ç—ã
```

### –°–µ–ª–µ–∫—Ç–æ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –≤ —Ç–µ—Å—Ç–∞—Ö. UI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–≥ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Playwright Inspector –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```bash
npm run test:e2e:debug
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `<feature>.e2e.js` –≤ `tests/e2e/`
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ö–µ–ª–ø–µ—Ä—ã –∏–∑ `./helpers/electron-launcher.js`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `beforeAll` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `afterAll` –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
5. –ü–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Playwright API

–ü—Ä–∏–º–µ—Ä:
```javascript
import { test, expect } from '@playwright/test';
import { launchElectronApp, closeElectronApp } from './helpers/electron-launcher.js';

let app, window;

test.beforeAll(async () => {
  const result = await launchElectronApp();
  app = result.app;
  window = result.window;
});

test.afterAll(async () => {
  await closeElectronApp(app);
});

test('should do something', async () => {
  await window.locator('#myButton').click();
  await expect(window.locator('#result')).toBeVisible();
});
```

## CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ CI (–Ω–∞–ø—Ä–∏–º–µ—Ä, GitHub Actions):

```yaml
- name: Run E2E tests
  run: npm run test:e2e
  env:
    CI: true
```

–í CI —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ headless —Ä–µ–∂–∏–º–µ
- –î–µ–ª–∞—é—Ç 2 retry –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- –°–æ—Ö—Ä–∞–Ω—è—é—Ç –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã (—Å–∫—Ä–∏–Ω—à–æ—Ç—ã, –≤–∏–¥–µ–æ) –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Playwright Documentation](https://playwright.dev/docs/intro)
- [Electron Testing with Playwright](https://playwright.dev/docs/api/class-electron)
- [Playwright Config Reference](https://playwright.dev/docs/test-configuration)

