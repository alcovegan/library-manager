# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

## –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Library Manager —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Windows, macOS –∏ Linux. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ö–æ—Ç—è—Ç –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –∫–Ω–∏–≥ —Å —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

- **SQLite –±–∞–∑–∞**: `userData/data/library.db`
- **–û–±–ª–æ–∂–∫–∏ –∫–Ω–∏–≥**: `userData/covers/` (—Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**: `userData/data/settings.json`
- **–ö—ç—à AI**: —Ç–∞–±–ª–∏—Ü–∞ –≤ SQLite

## –í–∞—Ä–∏–∞–Ω—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 1. S3-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ S3 (AWS) –∏–ª–∏ S3-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (MinIO, Wasabi, DigitalOcean Spaces) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ A ‚Üê‚Üí S3 Bucket ‚Üê‚Üí –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ B
                   ‚Üï
               –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```

#### –ü–ª—é—Å—ã
- ‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã**: —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: S3 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: 99.9% uptime
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, access keys
- ‚úÖ **–î–µ—à–µ–≤–∏–∑–Ω–∞**: ~$0.023/GB/–º–µ—Å—è—Ü –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- ‚úÖ **Backup –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**: –¥–∞–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—Ç—Å—è

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: –Ω—É–∂–Ω–æ —Ä–µ—à–∞—Ç—å –∫–æ–ª–ª–∏–∑–∏–∏ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- ‚ùå **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å S3 bucket
- ‚ùå **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç**: —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚ùå **API —Å–ª–æ–∂–Ω–æ—Å—Ç—å**: –Ω—É–∂–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å S3

#### –†–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
1. **Timestamp-based**: –ø–æ—Å–ª–µ–¥–Ω—è—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–±–µ–∂–¥–∞–µ—Ç
2. **Vector clocks**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
3. **Merge —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏**: –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã
4. **Manual resolution**: –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç

### 2. Git-based —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ A ‚Üê‚Üí Git Remote (GitHub/GitLab) ‚Üê‚Üí –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ B
```

#### –ü–ª—é—Å—ã
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: Git —É–º–µ–µ—Ç –∏—Ö —Ä–µ—à–∞—Ç—å
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç—å**: GitHub/GitLab –±–µ—Å–ø–ª–∞—Ç–Ω—ã –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ
- ‚úÖ **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω
- ‚úÖ **Merge tools**: –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–ë–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã**: –ø–ª–æ—Ö–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ–±–ª–æ–∂–µ–∫
- ‚ùå **–†–∞–∑–º–µ—Ä**: Git –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- ‚ùå **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –ø–æ–Ω–∏–º–∞—Ç—å Git
- ‚ùå **SQLite**: —Å–ª–æ–∂–Ω–æ –º–µ—Ä–∂–∏—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã –ë–î

### 3. WebDAV

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WebDAV —Å–µ—Ä–≤–µ—Ä–æ–≤ (Nextcloud, ownCloud, –∏–ª–∏ –æ–±—ã—á–Ω—ã–π WebDAV) –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

#### –ü–ª—é—Å—ã
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª
- ‚úÖ **Self-hosted**: –º–æ–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä
- ‚úÖ **–§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–±—ã—á–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
- ‚ùå **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: –Ω—É–∂–µ–Ω WebDAV —Å–µ—Ä–≤–µ—Ä
- ‚ùå **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –º–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 4. –û–±–ª–∞—á–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (Dropbox, Google Drive, iCloud)

#### –û–ø–∏—Å–∞–Ω–∏–µ
–†–∞–∑–º–µ—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–ø–∫–µ –æ–±–ª–∞—á–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

#### –ü–ª—é—Å—ã
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —ç—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—Å—Ç—å**: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∑—Ä–∞—á–Ω–∞
- ‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: —Å–æ–∑–¥–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞—Ö
- ‚ùå **SQLite –ø—Ä–æ–±–ª–µ–º—ã**: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –ø–æ–≤—Ä–µ–¥–∏—Ç—å—Å—è
- ‚ùå **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

### 5. –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

#### –û–ø–∏—Å–∞–Ω–∏–µ
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

#### –ü–ª—é—Å—ã
- ‚úÖ **–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å**: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ –Ω–∞—à–∏ –Ω—É–∂–¥—ã
- ‚úÖ **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã**: –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–º–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º —Ä–∞–±–æ—Ç—ã
- ‚ùå **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: –Ω—É–∂–µ–Ω —Ö–æ—Å—Ç–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞
- ‚ùå **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: –Ω—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä

### 6. P2P —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä—è–º–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –±–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

#### –ü–ª—é—Å—ã
- ‚úÖ **–ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å**: –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å**: –ø—Ä—è–º–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç—å**: –Ω–µ—Ç –∑–∞—Ç—Ä–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä

#### –ú–∏–Ω—É—Å—ã
- ‚ùå **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: NAT traversal, discovery
- ‚ùå **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–Ω–ª–∞–π–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚ùå **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ backup

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: S3-based —Å —É–º–Ω—ã–º conflict resolution

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ S3
```
bucket/
‚îú‚îÄ‚îÄ devices/
‚îÇ   ‚îú‚îÄ‚îÄ device-id-1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metadata.json (timestamp, version)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ heartbeat.json (last seen)
‚îÇ   ‚îî‚îÄ‚îÄ device-id-2/
‚îú‚îÄ‚îÄ library/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ current/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ library.db
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ library-v1.db
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ library-v2.db
‚îÇ   ‚îî‚îÄ‚îÄ covers/
‚îÇ       ‚îú‚îÄ‚îÄ book-1.jpg
‚îÇ       ‚îî‚îÄ‚îÄ book-2.png
‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îî‚îÄ‚îÄ settings.json
‚îî‚îÄ‚îÄ sync/
    ‚îú‚îÄ‚îÄ lock.json (distributed locking)
    ‚îî‚îÄ‚îÄ conflict-log.json
```

#### –ê–ª–≥–æ—Ä–∏—Ç–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

1. **Before Sync**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å lock (–µ—Å–ª–∏ –∑–∞–Ω—è—Ç - –∂–¥–∞—Ç—å)
   - –°–æ–∑–¥–∞—Ç—å lock —Å–æ —Å–≤–æ–∏–º device-id
   - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

2. **Download Phase**:
   - –°–∫–∞—á–∞—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –°—Ä–∞–≤–Ω–∏—Ç—å timestamps
   - –í—ã—è–≤–∏—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã

3. **Conflict Resolution**:
   - **Settings**: –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–±–µ–∂–¥–∞–µ—Ç
   - **Database**: merge –Ω–∞ —É—Ä–æ–≤–Ω–µ –∑–∞–ø–∏—Å–µ–π
   - **Covers**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ —Ö—ç—à—É —Ñ–∞–π–ª–∞

4. **Upload Phase**:
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
   - –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   - –°–Ω—è—Ç—å lock

#### –¢–∏–ø—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏–µ

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö**:
   - ‚úÖ –ú–µ—Ä–∂–∏–º –æ–±–µ –∫–Ω–∏–≥–∏

2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–Ω–∏–≥–∏**:
   - ü§î –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –≤–µ—Ä—Å–∏–∏
   - üìä –ú–µ—Ä–∂–∏–º –ø–æ–ª—è –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ"

3. **–£–¥–∞–ª–µ–Ω–∏–µ vs —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - ‚ùì –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - üõ°Ô∏è –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–Ω–∏–≥—É

4. **–û–±–ª–æ–∂–∫–∏**:
   - üì∏ –ï—Å–ª–∏ —Ö—ç—à–∏ —Ä–∞–∑–Ω—ã–µ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–µ –≤–µ—Ä—Å–∏–∏
   - üë§ –î–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±—Ä–∞—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 2: Hybrid –ø–æ–¥—Ö–æ–¥

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤:
- **S3**: –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ backup
- **Local sync folder**: –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å Dropbox/Drive
- **Manual export/import**: –¥–ª—è offline —Å–ª—É—á–∞–µ–≤

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### S3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```javascript
// aws-sdk –∏–ª–∏ @aws-sdk/client-s3
import { S3Client, PutObjectCommand, GetObjectCommand } from '@aws-sdk/client-s3';
```

#### Conflict resolution
```javascript
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
{
  deviceId: "uuid",
  lastSync: "2023-12-01T10:30:00Z",
  version: 15,
  changes: [
    {
      type: "book_added",
      bookId: "123",
      timestamp: "2023-12-01T10:25:00Z"
    }
  ]
}
```

#### Database merging
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `lastModified` –ø–æ–ª–µ –≤ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ
- Merge –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "newer wins"
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è rollback

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```
‚îå‚îÄ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚òê –í–∫–ª—é—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é                ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ –¢–∏–ø: S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ ‚ñº        ‚îÇ
‚îÇ Endpoint: https://s3.amazonaws.com      ‚îÇ
‚îÇ Bucket: my-library-sync                 ‚îÇ
‚îÇ Access Key: AKIA...                     ‚îÇ
‚îÇ Secret Key: ****                        ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ ‚òê –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç     ‚îÇ
‚îÇ ‚òê –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–ª–æ–∂–∫–∏             ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ [–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ] [–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```
üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è... (2 –∏–∑ 5 —Ñ–∞–π–ª–æ–≤)
‚úÖ –ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: 2 –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥
‚ö†Ô∏è –ö–æ–Ω—Ñ–ª–∏–∫—Ç: –Ω–∞–π–¥–µ–Ω–æ 3 –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –∑–∞–ø–∏—Å–∏
‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
```

## –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Phase 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- [ ] S3 client –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ UI
- [ ] –ë–∞–∑–æ–≤—ã–π upload/download –¥–∞–Ω–Ω—ã—Ö

### Phase 2: Conflict detection
- [ ] –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ timestamps
- [ ] –í—ã—è–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

### Phase 3: Conflict resolution
- [ ] UI –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ merge —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- [ ] Logging –∏ rollback

### Phase 4: UX improvements
- [ ] –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- [ ] Background sync
- [ ] –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- [ ] Offline mode

### Phase 5: Alternative methods
- [ ] Dropbox/Drive integration
- [ ] Manual export/import
- [ ] P2P sync (experimental)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- üîê **Client-side encryption**: –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è –¥–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ S3
- üîë **User-provided key**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç master password
- üì¶ **Encrypted database**: SQLite —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º (SQLCipher)

### –ü—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å
- üö´ **–ù–∏–∫–∞–∫–∏—Ö —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–π**: –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- üè† **Self-hosted option**: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π S3
- üë§ **–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å**: –Ω–µ—Ç –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ª–∏—á–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –î–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Git LFS**: –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –æ–±–ª–æ–∂–µ–∫
- **Syncthing**: P2P —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤
- **rsync**: –¥–ª—è Unix-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **SharePoint**: –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **WebDAV**: —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —Ñ–∞–π–ª–æ–≤—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- **API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: —Å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—á–∞—Ç—å —Å S3-based —Ä–µ—à–µ–Ω–∏—è –∫–∞–∫ –Ω–∞–∏–±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–≥–æ, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≤ –±—É–¥—É—â–µ–º.

S3 –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø—Ä–æ—Å—Ç–æ—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é, –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞–≤–ª—è—è –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
